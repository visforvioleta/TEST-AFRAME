<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>A-Frame Video Test</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <!-- Preload first frame, no autoplay -->
        <video id="video1" src="./assets/prueba.mp4" crossorigin="anonymous" preload="metadata" playsinline></video>
        <img id="playIcon" src="./assets/playbuton.png">
        <img id="pauseIcon" src="./assets/pausebuton.png">
      </a-assets>

      <!-- Video plane -->
      <a-video id="videoPlane" src="#video1" width="4" height="2.25" position="0 2 -6"></a-video>

      <!-- Play button -->
      <a-image id="btnPlay" src="#playIcon" width="0.5" height="0.5" position="-1 0.5 -6"
               visible="false"></a-image>

      <!-- Pause button -->
      <a-image id="btnPause" src="#pauseIcon" width="0.5" height="0.5" position="1 0.5 -6"
               visible="false"></a-image>

      <!-- Start experience plane -->
      <a-plane id="startButton" position="0 0 -2" width="2" height="1" color="#000">
        <a-text value="Haga clic para iniciar" align="center" position="0 0 0.01" color="#FFF"></a-text>
      </a-plane>

      <!-- Camera + cursor -->
      <a-entity camera look-controls>
        <a-cursor fuse="true" fuse-timeout="500"></a-cursor>
      </a-entity>
    </a-scene>

    <script>
      const videoEl = document.querySelector('#video1');
      const startButton = document.querySelector('#startButton');
      const playBtn = document.querySelector('#btnPlay');
      const pauseBtn = document.querySelector('#btnPause');

      // User must click this first to unlock video
      startButton.addEventListener('click', () => {
        startButton.setAttribute('visible', 'false');
        playBtn.setAttribute('visible', 'true');
        pauseBtn.setAttribute('visible', 'true');
        // Play right away, this click is a trusted gesture
        videoEl.play().catch(err => console.log("Video play blocked:", err));
      });

      playBtn.addEventListener('click', () => {
        videoEl.play();
      });

      pauseBtn.addEventListener('click', () => {
        videoEl.pause();
      });
    </script>
  </body>
</html>
